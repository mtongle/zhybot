# 🤖 zhybot

[English](README.md) | 中文文档

基于 NoneBot2 框架构建的综合性 QQ 机器人，拥有 12 个强大的插件模块！

---

## 📖 什么是 zhybot

Zhybot 是一个功能丰富的 QQ 机器人，专为群组管理和娱乐而设计。基于强大的 [Nonebot2 框架](https://nonebot.dev) 构建，具有广泛的插件架构，可实现可靠的消息自动化和高级功能。

---

## 🚀 核心功能

### 🤖 AI 聊天集成
> **具有 OpenAI 兼容 API 的智能对话系统**
- **功能特性：**
  - 自然对话，显示思考过程
  - 可配置的 AI 模型和提示词
  - 按机器人实例管理对话历史
  - 管理员命令调整模型/提示词
  - 多 API 密钥支持与负载均衡

### 🎵 音乐下载服务
> **来自流媒体平台的自动音乐下载**
- **功能特性：**
  - 自动检测网易云音乐链接
  - 高质量 MP3 下载
  - VIP 内容处理
  - 直接文件分享到群聊
- **支持平台：**
  - 🎧 网易云音乐 (music.163.com)

### 👍 智能点赞系统
> **具有定时功能的智能自动点赞**
- **使用方法：**
  ```bash
  *我                # 发送点赞（回复 * + 任意词语）
  定时赞 开/关       # 启用/禁用定时自动点赞
  ```
- **功能特性：**
  - 基于模式的点赞检测
  - 每日早上 5 点定时点赞
  - 批量群组操作
  - 可配置点赞次数和目标列表

### 🔍 数据库搜索
> **高级用户信息查询系统**
- **使用方法：**
  ```bash
  cx qq [id]     # 通过 QQ 号搜索手机号
  cx phone [id]  # 通过手机号搜索 QQ 号
  ```
- **功能特性：**
  - QQ号-手机号双向查询
  - MySQL 数据库集成
  - 性能计时显示

### 🛡️ 消息审核
> **自动内容过滤和用户管理**
- **功能特性：**
  - 管理员控制的封禁列表管理
  - 自动消息删除
  - 违规内容自动踢人
  - 按群组配置封禁规则

### 💣 消息轰炸器
> **用于测试目的的受控消息群发**
- **使用方法：**
  ```bash
  bomb
      -m|--message             # 要发送的消息
      -t|--times              # 发送次数
      -s|--speed              # 速度（消息/分钟）
      --enable-dangerous-mode # 高速度时需要危险模式
  ```
- **安全性：** 内置速率限制和危险模式保护

### 🎭 表情包生成
> **动态表情包创建系统**
- **功能特性：**
  - GIF 帧提取
  - 图像处理能力
  - 缓存表情包存储

### 📚 小说推荐
> **来自番茄平台的随机小说发现**
- **命令：** `来本小说` （获取小说）
- **功能特性：**
  - 随机图书推荐
  - 封面图片显示
  - 编码内容处理

### 🎉 欢迎系统
> **自动成员问候和管理**
- **功能特性：**
  - 新成员欢迎消息
  - 离群通知
  - 头像集成
  - 自定义问候模板

### 💻 系统命令接口
> **远程命令执行功能**
- **使用方法：** `run [命令]`
- **功能特性：**
  - 通过 sudo 实现安全用户隔离
  - 标准输出/错误输出捕获
  - 需要超级用户权限

### ⚙️ 配置管理
> **集中式机器人配置系统**
- **功能特性：**
  - 基于 JSON 的配置存储
  - 按机器人和全局设置
  - 使用默认值自动初始化
  - 类型安全的配置访问

### 🔧 实用工具函数
> **常用辅助函数和工具**
- **功能特性：**
  - 标准消息格式化
  - 机器人呼叫检测
  - Selenium 网页自动化工具

---

## 🏗️ 技术架构

### 框架与依赖
- **核心框架：** NoneBot2 搭配 OneBot V11 适配器
- **Python 版本：** 3.9+
- **插件系统：** 12 个专业插件的模块化架构
- **配置：** 集中式 JSON 配置管理

### 插件架构
```
src/plugins/
├── _aichat/          # AI 对话系统
├── _dailythings/     # 小说推荐
├── ban/              # 消息审核
├── bomb/             # 消息轰炸
├── config/           # 配置管理
├── cx/               # 数据库搜索
├── gen_meme/         # 表情包生成
├── likeme/           # 自动点赞系统
├── music/            # 音乐下载
├── run/              # 命令执行
├── utils/            # 实用工具函数
└── welcome/          # 成员问候
```

---

## 🚦 安装与设置

### 环境要求
- Python 3.9+
- MySQL 数据库（用于 cx 插件）
- Chrome/Chromium 浏览器（用于音乐插件）

### 快速开始
```bash
# 克隆仓库
git clone https://github.com/yourusername/zhybot.git
cd zhybot

# 安装依赖
pip install -r requirements.txt

# 配置机器人
cp config.json.example config.json
# 编辑 config.json 填入你的设置

# 运行机器人
python bot.py
```

---

## ⚙️ 配置说明

机器人使用 `config.json` 中的集中配置系统：

```json
{
  "default": {
    "openai_api_endpoint": "https://api.example.com/v1",
    "openai_api_keys": ["你的-api-密钥"],
    "openai_model": "gpt-3.5-turbo",
    "like_times": 50,
    "like_users": [],
    "like_groups": []
  }
}
```

### 主要配置项说明
- `openai_api_endpoint`: OpenAI 兼容 API 端点
- `openai_api_keys`: API 密钥列表（支持多个密钥轮换）
- `openai_model`: 使用的 AI 模型
- `like_times`: 每次点赞的数量
- `like_users`: 自动点赞的用户列表
- `like_groups`: 自动点赞的群组列表

---

## 🛡️ 安全注意事项

> ⚠️ **重要提醒：** 本项目包含一些敏感功能，部署时请注意：

- **数据库凭据：** cx 插件中包含数据库访问，请确保数据库安全
- **命令执行：** run 插件允许执行系统命令，请限制使用权限
- **个人数据：** 涉及 QQ-手机号映射等敏感信息，请遵守隐私法规
- **API 密钥：** 妥善保管 OpenAI API 密钥，避免泄露

---

## 📈 功能详解

### AI 聊天系统
支持多种 AI 模型，可显示思考过程，提供自然的对话体验。管理员可以实时调整模型参数和提示词。

### 音乐下载功能
自动识别网易云音乐分享链接，使用 Selenium 爬取歌曲信息，下载高质量音频文件并分享到群聊。

### 智能点赞系统
支持关键词触发点赞、定时点赞、批量操作等多种模式，可精确控制点赞对象和频率。

### 数据库查询
提供 QQ 号码和手机号码的双向查询功能，支持性能监控和查询统计。

---

## 🤝 贡献指南

欢迎提交问题和功能请求！

### 开发指南
- 遵循现有代码模式和约定
- 充分测试你的更改
- 为新功能更新文档
- 确保安全最佳实践

### 代码贡献流程
1. Fork 项目
2. 创建功能分支
3. 提交更改
4. 创建 Pull Request

---

## 📄 许可证

本项目是开源的，基于 [GPL-3.0 许可证](LICENSE) 提供。